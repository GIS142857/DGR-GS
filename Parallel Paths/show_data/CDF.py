import numpy as np
from scipy.stats import gamma, norm
import matplotlib.pyplot as plt

# 您的离散数据
data = np.array([9234.83, 5694.83, 4274.83, 4214.83, 8174.83, 11314.83, 8454.83, 9274.83, 2594.83, 10174.83, 7994.83, 6974.83, 6634.83, 7454.83, 16054.83, 15374.83, 15034.83, 13194.83, 12854.83, 24594.83, 28554.83, 27534.83, 50394.83, 47534.83, 32194.83, 28174.83, 25934.83, 13054.83, 18514.83, 10334.83, 9994.83, 15114.83, 15594.83, 16074.83, 18054.83, 18194.83, 16014.83, 12334.83, 12614.83, 16914.83, 15554.83, 15214.83, 13034.83, 11194.83, 15914.83, 19054.83, 21174.83, 26634.83, 21454.83, 23434.83, 23094.83, 27874.83, 15194.83, 13354.83, 14174.83, 18474.83, 17454.83, 15274.83, 17254.83, 6554.83, 13174.83, 15154.83, 13314.83, 14134.83, 16114.83, 18094.83, 15914.83, 9574.83, 17354.83, 16674.83, 19474.83, 22614.83, 32174.83, 37774.83, 35934.83, 72714.83, 72374.83, 72034.83, 77494.83, 78314.83, 73474.83, 67954.83, 69934.83, 68094.83, 68574.83, 70554.83, 70214.83, 69874.83, 69534.83, 69194.83, 67354.83, 64014.83, 69474.83, 73774.83, 73434.83, 69414.83, 73034.83, 72354.83, 70514.83, 70174.83, 70314.83, 70114.83, 72574.83, 63234.83, 59894.83, 59554.83, 61534.83, 66994.83, 68974.83, 64134.83, 67274.83, 60934.83, 56094.83, 54734.83, 55214.83, 60674.83, 48334.83, 34494.83, 39554.83, 39214.83, 41194.83, 34514.83, 30834.83, 30154.83, 28314.83, 23474.83, 23134.83, 25114.83, 22934.83, 22594.83, 21914.83, 21574.83, 24034.83, 26494.83, 28134.83, 26294.83, 24454.83, 21934.83, 26234.83, 27874.83, 26854.83, 29654.83, 20314.83, 6134.83, 2794.83, 6554.83, 3694.83, 17274.83, 15914.83, 19054.83, 25674.83, 28474.83, 28954.83, 24934.83, 25414.83, 19894.83, 16554.83, 8034.83, 32194.83, 28514.83, 28174.83, 28654.83, 32954.83, 30914.83, 29554.83, 27374.83, 28194.83, 26014.83, 19674.83, 20494.83, 17154.83, 16134.83, 15454.83, 17094.83, 17914.83, 9534.83, 7354.83, 11654.83, 8794.83, 16234.83, 15214.83, 13034.83, 13314.83, 11614.83, 13594.83, 6914.83, 11214.83, 12034.83, 6514.83, 13134.83, 11294.83, 14434.83, 14094.83, 14914.83, 11574.83, 6734.83, 15334.83, 20794.83, 17114.83, 21414.83, 23054.83, 22374.83, 20534.83, 28794.83, 40534.83, 39174.83, 41154.83, 43134.83, 42794.83, 44774.83, 51394.83, 56854.83, 54674.83, 58974.83, 68054.83, 73514.83, 76654.83, 78294.83, 77954.83, 77614.83, 72774.83, 80554.83, 80214.83, 79874.83, 69514.83, 58674.83, 59494.83, 50974.83, 47634.83, 49614.83, 48934.83, 52554.83, 50514.83, 49834.83, 54954.83, 56254.83, 55234.83, 57214.83, 49374.83, 42014.83, 40994.83, 40654.83, 40314.83, 43114.83, 42774.83, 43594.83, 41754.83, 40734.83, 41694.83, 50634.83, 50294.83, 42454.83, 40274.83, 39934.83, 33594.83, 37894.83, 35854.83, 45274.83, 45754.83, 43914.83, 41054.83, 36214.83, 29874.83, 22034.83, 24014.83, 24834.83, 25654.83, 25314.83, 31594.83, 56094.83, 58074.83, 60874.83, 64014.83, 72274.83, 73574.83, 76714.83, 75014.83, 61174.83, 55314.83, 50954.83, 51434.83, 58874.83, 54034.83, 50694.83, 53494.83, 53154.83, 52814.83, 54794.83, 54114.83, 50434.83, 44094.83, 40754.83, 34074.83, 39534.83, 34694.83, 48274.83, 47934.83, 50734.83, 56194.83, 55514.83, 55174.83, 64114.83, 74214.83, 68354.83, 79614.83, 70274.83, 68434.83, 65574.83, 68374.83, 70834.83, 75134.83, 64294.83, 62114.83, 67574.83, 70714.83, 86274.83, 87094.83, 86754.83, 89554.83, 91534.83, 92354.83, 90514.83, 92154.83, 94134.83, 87454.83, 84934.83, 88554.83, 86854.83, 87674.83, 80994.83, 87614.83, 90414.83, 93554.83, 88714.83, 90694.83, 93834.83, 95474.83, 98274.83, 93094.83, 90914.83, 92014.83, 92834.83, 92494.83, 91814.83, 89974.83, 93934.83, 81594.83, 83574.83, 81394.83, 89174.83, 91154.83, 109854.83, 105014.83, 103654.83, 115734.83, 118874.83, 118534.83, 116354.83, 116014.83, 117994.83, 118814.83, 123114.83, 133694.83, 133354.83, 148574.83, 147894.83, 157654.83, 158474.83, 153294.83, 158754.83, 162174.83, 161494.83, 161154.83, 158974.83, 156794.83, 161094.83, 160894.83, 164034.83, 166014.83, 170314.83, 160294.83, 154774.83, 157914.83, 157574.83, 160514.83, 154654.83, 156634.83, 148794.83, 143954.83, 142114.83, 146414.83, 140894.83, 150934.83, 152914.83, 151074.83, 160014.83, 158654.83, 159134.83, 160774.83, 163914.83, 162894.83, 162214.83, 159354.83, 167134.83, 182834.83, 173494.83, 173154.83, 170974.83, 167634.83, 168454.83, 164434.83, 167574.83, 170374.83, 171194.83, 170854.83, 173654.83, 174954.83, 177754.83, 175914.83, 156074.83, 155734.83, 154374.83, 150354.83, 150014.83, 150834.83, 148994.83, 144294.83, 131954.83, 123774.83, 124594.83, 130054.83, 127874.83, 123034.83, 111854.83, 107014.83, 105174.83, 102994.83, 107574.83, 107234.83, 109214.83, 108874.83, 98854.83, 93674.83, 93334.83, 98454.83, 97434.83, 99414.83, 96694.83, 95674.83, 97454.83, 99574.83, 90374.83, 94814.83, 99594.83, 99254.83, 92914.83, 92234.83, 86034.83, 73354.83, 79634.83, 76294.83, 77114.83, 77934.83, 75554.83, 73034.83, 76654.83, 74134.83, 73794.83, 73114.83, 67934.83, 75374.83, 73534.83, 77974.83, 78454.83, 80434.83, 79754.83, 80234.83, 81534.83, 82354.83, 81334.83, 86794.83, 88094.83, 90074.83, 91714.83, 101814.83, 102294.83, 100114.83, 86274.83, 104974.83, 99114.83, 101094.83, 92914.83, 92234.83, 91894.83, 88554.83, 89374.83, 94494.83, 99274.83, 100914.83, 105214.83, 100374.83, 101194.83, 98674.83, 110754.83, 104074.83, 109534.83, 110014.83, 107494.83, 101634.83, 95294.83, 94954.83, 98094.83, 97754.83, 97894.83, 98514.83, 95174.83, 94834.83, 96814.83, 94974.83, 95794.83, 89254.83, 85914.83, 79234.83, 75554.83, 75354.83, 72014.83, 62674.83, 60154.83, 67934.83, 62754.83, 69034.83, 72654.83, 74634.83, 77914.83, 81054.83, 78874.83, 78534.83, 87474.83, 85294.83, 81954.83, 78274.83, 65934.83, 73994.83, 82734.83, 86694.83, 87514.83, 84994.83, 85954.83, 84114.83, 76274.83, 76414.83, 78054.83, 73214.83, 63874.83, 63194.83, 67494.83, 65654.83, 68054.83, 65874.83, 61034.83, 59194.83, 58174.83, 52654.83, 56614.83, 61394.83, 62214.83, 65834.83, 64134.83, 67414.83, 62574.83, 62234.83, 55894.83, 55554.83, 51874.83, 49694.83, 44854.83, 51474.83, 50454.83, 50114.83, 55574.83, 52374.83, 56334.83, 52314.83, 50134.83, 49114.83, 37934.83, 38754.83, 37734.83, 37394.83, 38694.83, 38354.83, 37814.83, 34474.83, 34134.83, 37274.83, 38914.83, 43694.83, 37354.83, 38994.83, 38654.83, 39954.83, 40774.83, 41594.83, 41254.83, 36414.83, 18894.83, 15554.83, 17534.83, 17194.83, 9354.83, 12234.83, 10054.83, 13194.83, 12854.83, 6514.83, 10814.83, 14914.83, 14234.83, 25974.83, 25294.83, 24954.83, 26254.83, 32874.83, 36014.83, 38814.83, 38474.83, 32134.83, 23754.83, 23414.83, 25394.83, 25534.83, 24854.83, 37274.83, 38374.83, 39194.83, 47454.83, 54214.83, 52034.83, 53674.83, 58454.83, 58114.83, 74014.83, 69994.83, 72454.83, 69114.83, 69934.83, 71234.83, 73014.83, 70974.83, 80734.83, 69894.83, 70034.83, 83614.83, 90234.83, 96854.83, 96514.83, 93174.83, 93994.83, 97134.83, 95294.83, 93454.83, 91614.83, 93254.83, 106154.83, 107794.83, 101454.83, 101934.83, 109714.83, 109374.83, 109034.83, 102694.83, 114774.83, 110754.83, 111234.83, 114034.83, 114854.83, 110494.83, 107634.83, 114254.83, 107574.83, 113034.83, 111194.83, 113654.83, 105814.83, 104454.83, 110394.83, 105214.83, 108354.83, 101334.83, 97314.83, 111514.83, 108994.83, 107154.83, 112614.83, 121554.83, 116714.83, 109014.83, 107174.83, 111134.83, 109294.83, 108954.83, 101114.83, 97774.83, 86934.83, 78754.83, 81894.83, 79854.83, 78834.83, 84774.83, 85594.83, 77754.83, 78234.83, 71894.83, 76674.83, 84454.83, 84934.83, 84594.83, 86714.83, 88694.83, 96614.83, 95254.83, 98394.83, 95054.83, 94374.83, 93014.83, 105434.83, 105094.83, 126454.83, 120114.83, 119574.83, 120394.83, 119514.83, 116314.83, 118294.83, 114614.83, 109574.83, 99894.83, 104194.83, 105494.83, 107134.83, 110274.83, 108434.83, 106594.83, 113214.83, 106534.83, 104014.83, 107154.83, 110434.83, 106074.83, 105734.83, 105054.83, 111334.83, 113314.83, 109294.83, 107394.83, 99554.83, 97714.83, 86874.83, 86534.83, 86674.83, 80334.83, 78494.83, 82794.83, 84434.83, 84094.83, 89554.83, 93854.83, 96654.83, 94134.83, 90794.83, 92774.83, 83434.83, 81874.83, 81194.83, 82834.83, 72474.83, 69274.83, 67234.83, 65054.83, 61714.83, 65334.83, 60494.83, 58654.83, 58314.83, 67254.83, 60914.83, 72174.83, 72994.83, 67814.83, 74914.83, 76894.83, 78534.83, 71174.83, 68654.83, 64774.83, 65594.83, 64914.83, 69214.83, 68194.83, 66354.83, 68814.83, 66634.83, 62954.83, 56614.83, 56274.83, 55934.83, 60234.83, 52054.83, 52874.83, 52534.83, 59974.83, 56634.83, 58414.83, 59034.83, 53854.83, 62794.83, 59114.83, 61094.83, 66554.83, 53874.83, 54354.83, 52514.83, 54974.83, 54294.83, 53614.83, 53274.83, 51434.83, 52254.83, 51914.83, 53894.83, 48374.83, 46194.83, 41014.83, 41494.83, 41154.83, 39314.83, 43614.83, 47914.83, 56854.83, 66614.83, 67434.83, 67094.83, 65254.83, 74194.83, 78494.83, 82794.83, 101494.83, 101154.83, 97814.83, 83974.83, 98714.83, 108814.83, 114274.83, 109434.83, 97094.83, 94234.83, 104334.83, 103994.83, 109114.83, 109254.83, 105574.83, 100534.83, 125034.83, 127494.83, 124294.83, 123274.83, 113934.83, 114754.83, 114894.83, 111554.83, 112374.83, 112034.83, 111694.83, 113674.83, 113334.83, 112994.83, 108154.83, 111294.83, 112114.83, 113754.83, 114574.83, 120034.83, 125494.83, 126794.83, 126454.83, 127414.83, 127894.83, 140314.83, 135474.83, 131454.83, 133434.83, 135414.83, 127574.83, 127714.83, 130514.83, 128674.83, 126154.83, 123634.83, 129094.83, 123914.83, 122894.83, 126994.83, 121954.83, 123934.83, 122914.83, 123734.83, 126194.83, 128174.83, 125654.83, 129954.83, 122114.83, 122254.83, 127714.83, 129014.83, 128474.83, 132774.83, 132434.83, 127594.83, 122754.83, 126374.83, 126034.83, 116354.83, 113834.83, 101494.83, 101974.83, 98634.83, 100614.83, 91274.83, 90594.83, 80574.83, 84534.83, 82694.83, 79354.83, 86794.83, 94574.83, 92734.83, 90214.83, 89194.83, 85314.83, 87294.83, 85114.83, 73934.83, 84034.83, 83694.83, 83354.83, 83014.83, 93114.83, 93934.83, 91754.83, 92234.83, 87394.83, 97494.83, 102614.83, 94774.83, 92934.83, 76914.83, 85514.83, 84494.83, 77814.83, 82934.83, 73254.83, 78034.83, 80014.83, 75174.83, 75314.83, 71634.83, 72454.83, 66934.83, 56094.83, 55414.83, 56234.83, 54394.83, 48054.83, 49694.83, 47854.83, 47174.83, 38654.83, 37974.83, 37634.83, 32794.83, 29454.83, 31094.83, 36554.83, 39834.83, 45294.83, 48094.83, 43254.83, 44894.83, 45374.83, 38014.83, 37334.83, 41294.83, 31954.83, 49494.83, 49974.83, 42134.83, 31294.83, 35594.83, 38734.83, 35054.83, 32194.83, 27354.83, 39914.83, 51314.83, 54454.83, 52274.83, 47434.83, 50574.83, 48734.83, 53034.83, 56174.83, 57814.83, 60954.83, 57274.83, 60414.83, 50734.83, 53874.83, 49034.83, 48354.83, 43174.83, 42834.83, 49454.83, 50274.83, 59214.83, 55194.83, 54654.83, 54314.83, 58614.83, 61754.83, 59914.83, 55074.83, 52554.83, 53034.83, 52354.83, 51334.83, 56114.83, 56594.83, 59734.83, 66834.83, 66154.83, 64314.83, 63974.83, 64794.83, 62614.83, 71554.83, 70874.83, 72854.83, 72514.83, 64674.83, 63994.83, 59154.83, 57314.83, 67414.83, 58074.83, 54734.83, 58354.83, 50514.83, 43154.83, 40634.83, 38794.83, 41934.83, 43914.83, 33074.83, 37034.83, 36694.83, 36834.83, 41134.83, 50074.83, 50894.83, 45714.83, 46534.83, 38354.83, 33514.83, 38974.83, 42934.83, 38914.83, 35034.83, 34694.83, 37834.83, 34154.83, 33274.83, 29934.83, 42354.83, 40514.83, 54574.83, 44214.83, 43534.83, 37194.83, 38014.83, 37674.83, 38154.83, 39454.83])

# 使用 MLE 估计伽马分布参数
k_gamma, loc_gamma, scale_gamma = gamma.fit(data)

# 定义伽马分布 CDF 函数
def gamma_cdf(x):
  return gamma.cdf(x, k_gamma, loc=loc_gamma, scale=scale_gamma)

# 使用 MLE 估计高斯分布参数
mean_norm, std_norm = norm.fit(data)

# 定义高斯分布 CDF 函数
def norm_cdf(x):
  return norm.cdf(x, mean_norm, std_norm)

# 生成 x 轴数据范围
x_range = np.linspace(data.min(), data.max(), 100)

# 计算对应 x 值的累积概率
y_gamma_cdf = gamma_cdf(x_range)
y_norm_cdf = norm_cdf(x_range)

# 绘制 CDF 图
plt.plot(x_range, y_gamma_cdf, label='Fitted Gamma CDF')
plt.plot(x_range, y_norm_cdf, label='Fitted Normal CDF')
plt.scatter(data, gamma_cdf(data), color='red', label='Data Points', s=5)  # 将 s 设置为 20
plt.xlabel('X')
plt.ylabel('Cumulative Probability')
plt.title('Gamma and Normal Distribution CDF Fit')
plt.legend()
plt.grid(True)
plt.show()